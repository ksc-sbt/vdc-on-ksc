
# 如何在金山云上搭建专属虚拟数据中心.md

摘要

公有云服务商通过多租户共享物理机提供基于虚拟化技术的云服务器，在保证不同租户间安全隔离的前提下，提高物理机资源利用率，降低最终用户的购买成本。但某些用户希望自己拥有云服务器具有更好的隔离性，也就是希望所拥有的云服务器运行在自己独占的物理机上，满足行业合规性的要求，并更灵活的虚拟资源分配策略和具有更稳定的性能。

金山云提供了容器，共享云服务器，专属宿主机和云物理主机等完备的计算产品线，满足用户在资源使用粒度和隔离性等方面的不同需求。专属宿主机一方面给租户提供独占的物理资源，同时提供完备的服务器虚拟化管理和监控能力。用户可以在专属宿主机上创建虚拟化的专属云服务器。所创建的专属云服务器继承了标准共享云服务器在网络、存储等方面的能力，满足不同类型应用的上云需求。

和自建基于Vmware, OpenStack的私有虚拟化数据中心类似，我们需要为不同的计算负载提供不同的CPU、内存和硬盘等硬件配置的物理机。金山云云专属宿主机一方面及时采用最新的CPU，同时为计算密集型、内存密集型和IO密集型负载提供不同硬件配置，帮助客户在金山云搭建支撑不同计算负载的、完备的虚拟数据中心。下图利用金山云专属宿主机搭建企业专属虚拟数据中心的架构示意图。

![金山云专属虚拟数据中心(Dedicated Data Center Virtualization on KSC)架构](https://raw.githubusercontent.com/ksc-sbt/vdc-on-ksc/master/vdc-on-ksc-architecture.png)

在上图中，基于金山云提供的不同类型的专属宿主机，分别建立计算集群、数据集群和缓存集群。

|宿主机集群名称|宿主机型号|CPU类型|CPU Cores|Threads|CPU主频|内存(DDR4)|硬盘|专属云服务器系统盘|专属云服务器数据盘|使用场景|
|----|----|----|----|----|----|----|----|----|----|----|
|计算宿主机集群|计算型DC2|Intel® Xeon® Processor E5-2690 v4|14 * 2|28 * 2|2.6GHz|108GB|800G SSD|本地盘: 20G*|本地盘: <800G SSD; 云硬盘: 16000G * 3 SSD/云主机|计算密集型负载，比如Web服务|
|数据宿主机集群|标准型DS2|Intel® Xeon® Gold 6132 Processor|14 * 2|28 * 2|2.6GHz|356GB|5900GB SSD|本地盘: 20G*|本地盘: <5900GB SSD; 云硬盘: 16000G * 3 SSD/云主机|IO密集型负载，比如数据库|
|缓存宿主机集群|通用型DN2|Intel® Xeon® Platinum 8168 Processor|24 * 2|48 * 2|2.7GHz|734GB|无|云硬盘：20-500G|云硬盘: 16000G * 3 SSD/云主机|内存密集型资源，比如Redis缓存|
*说明：如果专属云服务器是Windows操作系统，缺省系统盘大小为50G.

下面通过在专属宿主机上运行用于运行缓存服务（比如Redis）的专属云服务器的操作过程，介绍金山云专属宿主机的使用方法。

本文包括下列内容：
* 网络规划
* 管理金山云专属宿主机
* 管理金山云专属云服务器
* 监控专属云宿主机和云服务器

更多详细信息，请参考[金山云宿主机在线帮助: https://docs.ksyun.com/products/71](https://docs.ksyun.com/products/71)

# 1 网络规划

对于企业数据中心而言，通常分为开发环境、测试环境和生产环境。出于信息安全考虑，这些环境之间需要进行一定程度的隔离。基于这个考虑，企业在金山云上建立专属虚拟数据中心时，建议针对开发、测试和生产环境建立不同的VPC。此外，建立一个独立的堡垒机VPC，该VPC用于管理用于云服务器访问控制和操作审计的堡垒机。堡垒机VPC和另外三个VPC之间通过对等连接(VPC Peering)进行互通。关于金山云云服务器访问控制和操作审计，以及本文所依赖的网络环境，请参考文章[《金山云云服务器访问控制和操作审计》：https://github.com/ksc-sbt/bastion/blob/master/金山云云服务器访问控制和操作审计.md](https://github.com/ksc-sbt/bastion/blob/master/金山云云服务器访问控制和操作审计.md)

# 2 管理金山云专属宿主机
当专属宿主机数量较多时，可把相同规格的专属宿主机分配到不同的专属宿主机集群中。

## 2.1 管理专属宿主机集群
下面创建一个包含“通用型DN2”规格的缓存宿主机集群，用户可以增加新的宿主机集群。下图是管理宿主机集群的界面。

![管理专属宿主机集群](https://raw.githubusercontent.com/ksc-sbt/vdc-on-ksc/master/kdh-clusters.png)

## 2.1 管理专属宿主机
点击特定的专属宿主机集群，可进入集群的详情界面，该界面显示了集群中的专属宿主机列表。下图是“缓存集群“包含的两台“通用型DN2”规格的宿主机：
![专属宿主机集群详情](https://raw.githubusercontent.com/ksc-sbt/vdc-on-ksc/master/kdh-cluster-detail.png)
此外，通过专属宿主机界面，也可以管理专属宿主机。操作界面如下：
![专属宿主机列表](https://raw.githubusercontent.com/ksc-sbt/vdc-on-ksc/master/kdh-list.png)

# 3 管理金山云专属云服务器
在创建专属宿主机集群和专属宿主机后，下面就可以创建运行在专属宿主机上的专属云服务器。


* 监控专属云宿主机和云服务器




























